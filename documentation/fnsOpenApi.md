https://kkt-online.nalog.ru/ap-description/

## Основные пункты в соглашении по использованию open Api от фнс:
- Предоставление функционала конечному пользователю - на безвозмездной основе.
- Допустимые объемы информационного обмена устанавливаются и изменяются ФНС России в одностороннем порядке
  в зависимости от имеющихся технических возможностей, с учетом нагрузки, формируемой Внешними пользователями,
  а также по иным причинам, включая несоблюдение Внешними пользователями настоящих условий.
- Для получения доступа к Сервису Внешний пользователь обязан путем подачи Заявки зарегистрироваться в Сервисе и
  получить Мастер-токен. Внешний пользователь не имеет права использовать любые программы, устройства или иные средства,
  позволяющие получить Мастертокен автоматическим путем или иным образом с нарушением установленной процедуры.
  
## Технические условия:
3.1. Для подключения к Сервису Пользователю необходимо подать в Управление оперативного контроля ФНС России Заявку по 
форме, размещенной на сайте kkt@tax.gov.ru, в разделе «Open API». 
3.2. Заявка должна содержать следующие данные: 
    - полное наименование юридического лица или фамилию имя и отчество индивидуального предпринимателя, 
согласно учредительным документам; 
    - ИНН юридического лица или индивидуального предпринимателя; 
    - наименование (бренд) продукта; 
    - url-ресурса; 
    - перечень IP-адреса/ов с которого будет осуществляться запрос на проверку факта записи расчета и подлинности 
      фискального признака; 
    - описание пользовательского продукта, предполагаемых пользовательских сценариев при применении Сервиса; 
    - полные фамилию, имя, отчество, должность, адрес электронной почты и номер телефона ответственного лица для 
    взаимодействия с ФНС России; 
    - перечень прилагаемых документов (Приложение). 
3.3. Все данные указанные в Заявке должны быть заполнены согласно учредительным документам юридического лица или 
     индивидуального предпринимателя. 
3.4. Заполнение формы Заявки производится с использованием прикладного программного обеспечения для редактирования 
     PDF-файлов либо заполняется от руки печатными буквами. 
3.5. Заполнение Заявки от руки осуществляется читаемым подчерком чернилами черного или синего цвета заглавными 
     печатными буквами, цифрами и символами. Не допускаются сокращения, исправления и дописки (приписки). 
3.6. Номер телефона, адрес электронной почты, гиперссылка указывается без пробелов и прочерков. Номер стационарного 
     телефона указывается с междугородным телефонным кодом.  
3.7. Не допускается указание IP-адреса с диапазоном маски. Пользователь может указать не более четырех IP-адресов. 
     В случае предоставления более четырех IP-адресов, Пользователь направляет в ФНС запрос с обоснованием подключения 
     дополнительных IP-адресов (суммарно не более восьми).  
3.8. Для юридического лица Заявка должна быть подписана генеральным директором/директором 
     (или уполномоченным лицом по доверенности) с указанием должности и расшифровкой фамилии, имени и отчества 
     (при наличии) и скреплена печатью. Факсимиле не 3 Условия использования Сервиса ФНС России «Открытое API 
     проверка чека ККТ» Версия от 07.04.2022 допускается. В случае подписания Заявки лицом по доверенности, 
     доверенность должна быть оформлена на официальном бланке юридического лица, содержать необходимые полномочия, 
     подписана генеральным директором и скреплена печатью.  Для индивидуального предпринимателя Заявка должна быть 
     подписана индивидуальным предпринимателем с расшифровкой фамилии, имени и отчества (при наличии) и 
     скреплена печатью (при наличии). Факсимиле не допускается. 
3.9. Подача Заявки возможна двумя способами: 
     1) на электронный адрес kkt@tax.gov.ru 
        - с обязательной темой обращения «Заявка на Open API + наименование Заявителя» строго в формате PDF, 
        завизированной и отсоединенной к ЗаявкеУКЭП Пользователя. Подлинность и валидность УКЭП можно проверить 
        через электронный сервис сайта Портала государственных услуг Российской Федерации 
        – «Подтверждение подлинности электронной подписи» (http://www.gosuslugi.ru/pgu/eds/). При визировании заявки 
        УКЭП уполномоченным сотрудником Заявителя, необходимо приложить доверенность на право использования электронной 
        подписи. 
     2) на бумажном носителе с сопроводительным письмом на официальном бланке юридического лица или индивидуального 
     предпринимателя в адрес Управления оперативного контроля ФНС России 
        - заказным почтовым отправлением или курьером через службу экспедиции «Бюро пропусков» Центрального аппарата 
          ФНС России, расположенный по адресу: г. Москва, ул. Неглинная, д. 23. При себе необходимо иметь документ, 
          удостоверяющий личность, сопроводительное письмо, оригинал Заявки, оригинал доверенности.  
3.10. Срок рассмотрения Заявки составляет 30 календарных дней с момента ее получения ФНС России. 
3.11. При положительном решении рассмотрения заявки на подключение к Сервису, на электронную почту, указанную в 
      заявке для обратной связи, будет направлено письмо, в ответ на которое необходимо направить логотип организации 
      в виде файла в формате *.png или *.jpg размером не менее 200х200 пикселей. 
3.12. ФНС России предоставляет доступ к Сервису путем выдачи Мастер-токена и адреса сервиса аутентификации, 
      доступ к которым предоставляется в течении пяти рабочих дней с момента принятия положительного решения по заявке. 
      Данные для доступа направляются на указанный в Заявке адрес электронной почты для обратной связи. 
      Внешний пользователь обязан установить первую сессию в течении пяти календарных дней с момента получения 
      Мастер-токена. 

##  Сервис сообщений
4.1. Сервис построен на основе контрактов данных и предназначен для предоставления возможности публикации открытых 
     сервисов ФНС России для предоставления доступа Внешним пользователям, получившим Мастер-токен. 
4.2. Для информационного обмена используется асинхронный режим с использованием SendMessage и GetMessage: 
4.3. Метод отправки сообщения SendMessage предназначен для отправки xml сообщения в соответствии с определенной 
     для конкретного сервиса схемой. 
     4 Сигнатура метода: Условия использования Сервиса ФНС России «Открытое API 
     проверка чека ККТ» Версия от 07.04.2022 

    **SendMessageResponse SendMessage(SendMessageRequest request) throws AuthenticationException**, где 
    *SendMessageRequest* – запрос, содержащий единственный элемент 
    *Message* – сообщение, который позволяет содержать любой xml с обязательным указанием схемы.

    Пример: 
    **<CheckTicketRequest xmlns="urn://x-artefacts-gnivcru/inplat/servin/OpenApiAsyncMessageConsumerService/types/1.0"> … </CheckTicketRequest>** 
    *SendMessageResponse* – ответ, содержащий единственный элемент 
    *MessageId* – идентификатор сообщения, присвоенный запросу, который требуется сохранить для дальнейшего обращения 
                за ответом. В результате вызова метод может вернуть исключение AuthenticationException, указывающее 
                на то, что были переданы неверные аутентификационные реквизиты, либо на то, что закончилось время их 
                действия. 
4.3. Метод получения сообщения GetMessage предназначен для получения xml сообщения в соответствии с определенной 
     для конкретного сервиса схемой. 
    Сигнатура метода: 

    **GetMessageResponse GetMessage(GetMessageRequest request) throws AuthenticationException, MessageNotFoundException**, где 
    *GetMessageRequest* – запрос, содержащий единственный элемент 
    *MessageId* – идентификатор сообщения, присвоенный запросу, который требуется передать для получения ответа. 
    *GetMessageResponse* – ответ, содержащий 2 элемента: 
            *ProcessingStatus* – статус выполнения запроса, и 
            *Message* – сообщение, который позволяет содержать любой xml с обязательным указанием схемы.  
    *ProcessingStatus* – перечисление, с двумя значениями: 
            PROCESSING – запрос обрабатывается, 
            COMPLETED – обработка запроса завершена. 
            Элемент Message возвращается только в случае, если ProcessingStatus равен COMPLETED. 

    Пример: 
    <ns:GetMessageResponse> 
        <ns:ProcessingStatus>COMPLETED</ns:ProcessingStatus>
        <ns:Message> 

            <CheckTicketResponse xmlns="urn://x-artefacts-gnivcru/inplat/servin/OpenApiAsyncMessageConsumerService/ types/1.0"> 
            </CheckTicketResponse> 

         </ns:Message> 
    </ns:GetMessageResponse> 

## Условия использования Сервиса ФНС России «Открытое API проверка чека ККТ» Версия от 07.04.2022 
5. Правила именования и организации элементов в схеме Сервиса 
5.1. Правила именования элементов в схеме Сервиса, если иное не установлено ФНС России дополнительно, 
     соответствуют следующим правилам: 
5.2. Элементы схемы вида MethodRequest предназначены для передачи в качестве запросов к соответствующим методам; 
5.3. Элементы схемы вида MethodResponse предназначены для получения в качестве ответа от соответствующего метода. 
     MethodResponse содержит два взаимоисключающих элемента: Result и Fault. 
     *Result* – возвращается в случае успешного вызова метода, 
     *Fault* – в случае наличия ошибок. 

